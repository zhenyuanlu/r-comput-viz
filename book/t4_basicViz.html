<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Basic Data Visualization in R - Computation and Visualization in R</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="home.html">Home</a></li><li class="chapter-item expanded affix "><a href="dis.html">Disclaimer</a></li><li class="chapter-item expanded affix "><a href="faq.html">FAQ for the class</a></li><li class="chapter-item expanded "><a href="t1_basicR.html"><strong aria-hidden="true">1.</strong> Basic of R</a></li><li class="chapter-item expanded "><a href="t2_func.html"><strong aria-hidden="true">2.</strong> R Functions</a></li><li class="chapter-item expanded "><a href="t3_gramar.html"><strong aria-hidden="true">3.</strong> The Grammar of Graphics</a></li><li class="chapter-item expanded "><a href="t4_basicViz.html" class="active"><strong aria-hidden="true">4.</strong> Basic Data Visualization in R</a></li><li class="chapter-item expanded "><a href="t5_transData.html"><strong aria-hidden="true">5.</strong> Data Transformation with dplyr</a></li><li class="chapter-item expanded "><a href="t6_dataWrangling_trt.html"><strong aria-hidden="true">6.</strong> Data Wrangling with tibbles, readr and tidyr</a></li><li class="chapter-item expanded "><a href="t7_dataWrangling_sf.html"><strong aria-hidden="true">7.</strong> (optional) Data Wrangling with stringr, forcats</a></li><li class="chapter-item expanded "><a href="t8_relational.html"><strong aria-hidden="true">8.</strong> Visualizing Relational Data</a></li><li class="chapter-item expanded "><a href="t9_shiny.html"><strong aria-hidden="true">9.</strong> Introduction to Shiny</a></li><li class="chapter-item expanded "><a href="t10_eda.html"><strong aria-hidden="true">10.</strong> Exploratory Data Analysis and More Data Visualization</a></li><li class="chapter-item expanded "><a href="t11_additional.html"><strong aria-hidden="true">11.</strong> R Modeling Workshop</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Computation and Visualization in R</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/zhenyuanlu/r-comput-viz" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="basic-data-visualization-in-r"><a class="header" href="#basic-data-visualization-in-r">Basic Data Visualization in R</a></h1>
<h2 id="chart-selection"><a class="header" href="#chart-selection">Chart selection</a></h2>
<p>A great explanation on selecting a right chart type by Dr. Andrew Abela.</p>
<p>but as a data scientist should not be limited by this.</p>
<p align="center">
  <img src="images/t4/1.png" style="width:100%"/>
</p>
<h2 id="components-of-the-plots"><a class="header" href="#components-of-the-plots">Components of the plots</a></h2>
<ul>
<li>Layers:
<ul>
<li>Dataset</li>
<li>Aesthetic mapping (color, shape, size, etc.)</li>
<li>Statistical transformation</li>
<li>Geometric object (line, bar, dots, etc.)</li>
<li>Position adjustment</li>
</ul>
</li>
<li>Scale (optional)</li>
<li>Coordinate system</li>
<li>Faceting (optional)</li>
<li>Defaults</li>
</ul>
<h2 id="ggplot2-full-syntax"><a class="header" href="#ggplot2-full-syntax">ggplot2 full syntax</a></h2>
<pre><code class="language-r">ggplot(data = &lt;DATASET&gt;,
       mapping = aes( &lt;MAPPINGS&gt;) +
        layer(geom = &lt;GEOM&gt;,
              stat = &lt;STAT&gt;,
              position = &lt;POSITION&gt;) +
        &lt;SCALE_FUNCTION&gt;() +
        &lt;COORDINATE_FUNCTION&gt;() +
        &lt;FACET_FUNCTION&gt;()
</code></pre>
<h3 id="a-typical-graph-template"><a class="header" href="#a-typical-graph-template">A typical graph template</a></h3>
<pre><code class="language-r">ggplot(data = &lt;DATASET&gt; ,
      mapping = aes(&lt;MAPPINGS)) +
      &lt;GEOM_FUNCTION&gt;()
</code></pre>
<h2 id="creat-a-plot-with-basic-data"><a class="header" href="#creat-a-plot-with-basic-data">Creat a plot with basic data</a></h2>
<pre><code class="language-r">ggplot(data=mpg)+
  geom_point(mapping = aes(x=displ&gt;2,y=hwy))
</code></pre>
<p align="center">
  <img src="images/t4/2.png" style="width:70%"/>
</p>
<pre><code class="language-r">ggplot(data=mpg[mpg$model==&quot;a4&quot;,])+
  geom_point(mapping = aes(x=displ,y=hwy))
</code></pre>
<p align="center">
  <img src="images/t4/3.png" style="width:70%"/>
</p>
<h2 id="aesthetic-mappings"><a class="header" href="#aesthetic-mappings">Aesthetic Mappings</a></h2>
<p>The greatest value of a picture is when it forces us to notice what we never expected to see.</p>
<p>—John Tukey</p>
<p>Basic components of aesthetic mapping:</p>
<ul>
<li>Mapping</li>
<li>Size</li>
<li>Alpha</li>
<li>Shape</li>
<li>Color</li>
</ul>
<p>Map the colors of your points to the class variable to reveal the class of each car:</p>
<h3 id="aesthetic-mappings-mapping"><a class="header" href="#aesthetic-mappings-mapping">Aesthetic Mappings: Mapping</a></h3>
<pre><code class="language-r">ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy, color = class))
</code></pre>
<p align="center">
  <img src="images/t4/4.png" style="width:70%"/>
</p>
<h3 id="aesthetic-mappings-size"><a class="header" href="#aesthetic-mappings-size">Aesthetic Mappings: Size</a></h3>
<p>Not recommend mapping an unordered variable to an ordered aesthetic:</p>
<pre><code class="language-r">ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy, size = class))
</code></pre>
<p align="center">
  <img src="images/t4/5.png" style="width:70%"/>
</p>
<h3 id="aesthetic-mappings-alpha"><a class="header" href="#aesthetic-mappings-alpha">Aesthetic Mappings: Alpha</a></h3>
<pre><code class="language-r">ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy, alpha = class))
</code></pre>
<p align="center">
  <img src="images/t4/6.png" style="width:70%"/>
</p>
<h3 id="aesthetic-mappings-shape"><a class="header" href="#aesthetic-mappings-shape">Aesthetic Mappings: Shape</a></h3>
<pre><code class="language-r">ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy, shape = class))
</code></pre>
<p align="center">
  <img src="images/t4/7.png" style="width:70%"/>
</p>
<blockquote>
<p>What happened to the SUVs? ggplot2 will only use six shapes at a time.</p>
<p>By default, additional groups will go unplotted when you use this aesthetic.</p>
</blockquote>
<p>R has 25 built-in shapes that are identified by numbers</p>
<p align="center">
  <img src="images/t4/8.png" style="width:70%"/>
</p>
<h3 id="aesthetic-mappings-color"><a class="header" href="#aesthetic-mappings-color">Aesthetic Mappings: Color</a></h3>
<p>For each aesthetic you use, the aes() to associate the name of the aesthetic with a variable to display. The aes() function gathers together each of the aesthetic mappings used by a layer and passes them to the layer’s mapping argument.</p>
<pre><code class="language-r">ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy), color = &quot;blue&quot;)
</code></pre>
<p align="center">
  <img src="images/t4/9.png" style="width:70%"/>
</p>
<blockquote>
<h2 id="exercise"><a class="header" href="#exercise">Exercise</a></h2>
<ul>
<li>
<p>Which variables in mpg are categorical? Which variables are continuous? (Hint: type ?mpg to read the documentation for the dataset.) How can you see this information when you run mpg?</p>
</li>
<li>
<p>Map a continuous variable to color, size, and shape. How do these aesthetics behave differently for categorical versus continuous variables?</p>
</li>
</ul>
</blockquote>
<h2 id="facets"><a class="header" href="#facets">Facets</a></h2>
<h3 id="facets-facet_wrap"><a class="header" href="#facets-facet_wrap">Facets: <code>facet_wrap()</code></a></h3>
<p>The first argument of facet_wrap() should be a formula, which you create with ~ followed by a variable name (here “formula” is the name of a data structure in R, not a synonym for “equation”).
To facet your plot by a single variable (discrete), use facet_wrap()</p>
<pre><code class="language-r">ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy)) +
  facet_wrap( ~ class, nrow = 2)
</code></pre>
<p align="center">
  <img src="images/t4/10.png" style="width:90%"/>
</p>
<h3 id="facets-facet_grid"><a class="header" href="#facets-facet_grid">Facets: <code>facet_grid()</code></a></h3>
<p>To facet your plot on the combination of two variables, add facet_grid() to your plot call.</p>
<pre><code class="language-r">ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy)) +
  facet_grid(drv ~ cyl)
</code></pre>
<p align="center">
  <img src="images/t4/11.png" style="width:90%"/>
</p>
<blockquote>
<p><strong>Tip</strong>:</p>
<p>If you want to use <code>facet_wrap</code> to do the above plot.</p>
<pre><code class="language-r">ggplot(data = mpg) +
 geom_point(mapping = aes(x = displ, y = hwy)) +
 facet_wrap(drv ~ cyl)
</code></pre>
<p>You will see,</p>
<p align="center">
 <img src="images/t4/12.png" style="width:90%"/>
</p>
This is the difference between `facet_wrap` and `facet_grid`.
</blockquote>
<h2 id="geometric-objects"><a class="header" href="#geometric-objects">Geometric Objects</a></h2>
<p>A geom is the geometrical object that a plot uses to represent data. People often describe plots by the type of geom that the plot uses. For example, bar charts use bar geoms, line charts use line geoms, boxplots use boxplot geoms, and so on.</p>
<pre><code class="language-r">ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy))
</code></pre>
<p align="center">
  <img src="images/t4/13.png" style="width:70%"/>
</p>
<p><em><code>geom_smooth()</code>: 95% confidence level interval for predictions</em></p>
<pre><code class="language-r">ggplot(data = mpg) +
  geom_smooth(mapping = aes(x = displ, y = hwy))
</code></pre>
<p align="center">
  <img src="images/t4/14.png" style="width:70%"/>
</p>
<p>What if we would like to group the <code>smooth_line</code> by drv?</p>
<pre><code class="language-r">ggplot(data = mpg) +
  geom_smooth(mapping = aes(x = displ, y = hwy, group = drv))
</code></pre>
<p align="center">
  <img src="images/t4/15.png" style="width:70%"/>
</p>
<p>Now, arrange colors on different type of drv.</p>
<pre><code class="language-r">ggplot(data = mpg) +
  geom_smooth(mapping = aes(x = displ, y = hwy, color = drv),
  show.legend = FALSE)
</code></pre>
<p align="center">
  <img src="images/t4/16.png" style="width:70%"/>
</p>
<p>We can also add up one more geom layer to the current one.</p>
<pre><code class="language-r">ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy)) +
  geom_smooth(mapping = aes(x = displ, y = hwy))
</code></pre>
<p align="center">
  <img src="images/t4/17.png" style="width:70%"/>
</p>
<h3 id="global-and-local-mappings"><a class="header" href="#global-and-local-mappings">Global and local mappings</a></h3>
<pre><code class="language-r">ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy)) +
  geom_smooth(mapping = aes(x = displ, y = hwy))
</code></pre>
<p>ggplot2 will treat these mappings as global mappings that apply to each geom in the graph. In other words, this code will produce the same plot as the previous code:</p>
<pre><code class="language-r">ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
  geom_point() +
  geom_smooth()
</code></pre>
<h4 id="local-mappings"><a class="header" href="#local-mappings">Local mappings</a></h4>
<pre><code class="language-r">ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy)) +
  geom_smooth(mapping = aes(x = displ, y = hwy, color=class))
</code></pre>
<p align="center">
  <img src="images/t4/18.png" style="width:70%"/>
</p>
<h4 id="global-mapping"><a class="header" href="#global-mapping">Global mapping</a></h4>
<pre><code class="language-r">ggplot(data = mpg, mapping = aes(x = displ, y = hwy, color=class)) +
  geom_point() +
  geom_smooth()
</code></pre>
<p align="center">
  <img src="images/t4/19.png" style="width:70%"/>
</p>
<p>Change the color for <code>geom_point</code> layer only.</p>
<pre><code class="language-r">ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
  geom_point(mapping = aes(color = class)) +
  geom_smooth()
</code></pre>
<p align="center">
  <img src="images/t4/20.png" style="width:70%"/>
</p>
<h4 id="filter-out-data-in-a-layer"><a class="header" href="#filter-out-data-in-a-layer">Filter out data in a layer</a></h4>
<pre><code class="language-r">ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
  geom_point(mapping = aes(color = class)) +
  geom_smooth(data = mpg[mpg$class == &quot;subcompact&quot;, ],
  se = FALSE)
</code></pre>
<p align="center">
  <img src="images/t4/21.png" style="width:70%"/>
</p>
<pre><code class="language-r">ggplot(data = mpg, mapping = aes(x = displ, y = hwy)) +
  geom_point(mapping = aes(color = cty&gt;16))
</code></pre>
<p align="center">
  <img src="images/t4/22.png" style="width:70%"/>
</p>
<pre><code class="language-r">ggplot(data = mpg, mapping = aes(x = displ&gt;4, y = cty)) +
  geom_boxplot()
</code></pre>
<p align="center">
  <img src="images/t4/23.png" style="width:70%"/>
</p>
<h3 id="asfactor"><a class="header" href="#asfactor"><code>as.factor()</code></a></h3>
<pre><code class="language-r">ggplot(mpg, aes(x = displ, y = hwy)) +
  geom_point(aes(color = as.factor(cty)), size=5)
</code></pre>
<p align="center">
  <img src="images/t4/24.png" style="width:70%"/>
</p>
<blockquote>
<p><strong>Exercise 1</strong></p>
<p>Re-create the R code necessary to generate the following graphs.</p>
<table><thead><tr><th style="text-align: center">a</th><th style="text-align: center">b</th></tr></thead><tbody>
<tr><td style="text-align: center"><img src="images/t4/25.png" alt="" /></td><td style="text-align: center"><img src="images/t4/26.png" alt="" /></td></tr>
</tbody></table>
</blockquote>
<p>a</p>
<pre><code class="language-r">ggplot(mpg,
       aes(x = displ, y = hwy)) +
  geom_point(size=5) +
  geom_smooth(se=F)
</code></pre>
<p>b</p>
<pre><code class="language-r">ggplot(mpg,
       aes(x = displ, y = hwy)) +
  geom_point(size=5) +
  geom_smooth(aes(class=drv),se=F)
</code></pre>
<blockquote>
<p><strong>Exercise 2</strong></p>
<p>Re-create the R code necessary to generate the following graphs.</p>
<table><thead><tr><th style="text-align: center">a</th><th style="text-align: center">b</th></tr></thead><tbody>
<tr><td style="text-align: center"><img src="images/t4/27.png" alt="" /></td><td style="text-align: center"><img src="images/t4/28.png" alt="" /></td></tr>
</tbody></table>
</blockquote>
<p>a</p>
<pre><code class="language-r">ggplot(mpg,
       aes(x = displ, y = hwy)) +
  geom_point(aes(color=drv)) +
  geom_smooth(aes(class=drv, color=drv),se=F)
</code></pre>
<p>b</p>
<pre><code class="language-r">ggplot(mpg,
       aes(x = displ, y = hwy)) +
  geom_point(aes(color=drv)) +
  geom_smooth(se=F)
</code></pre>
<blockquote>
<p><strong>Exercise 3</strong></p>
<p>Re-create the R code necessary to generate the following graphs.</p>
<table><thead><tr><th style="text-align: center">a</th><th style="text-align: center">b</th></tr></thead><tbody>
<tr><td style="text-align: center"><img src="images/t4/29.png" alt="" /></td><td style="text-align: center"><img src="images/t4/30.png" alt="" /></td></tr>
</tbody></table>
</blockquote>
<p>a</p>
<pre><code class="language-r">ggplot(mpg,
       aes(x = displ, y = hwy)) +
  geom_point(aes(color=drv)) +
  geom_smooth(aes(class=drv, color=drv, shape=drv, linetype=drv),se=F)
</code></pre>
<p>b</p>
<pre><code class="language-r">ggplot(mpg,
       aes(x = displ, y = hwy)) +
  geom_point(aes(fill=drv), shape=21, color=&quot;white&quot;, size=5, stroke=5) +
  geom_smooth(se=F)
</code></pre>
<h3 id="statistical-transformation"><a class="header" href="#statistical-transformation">Statistical transformation</a></h3>
<p>Many graphs, like scatterplots, plot the raw values of your dataset. Other graphs,
like bar charts, calculate new values to plot.</p>
<p>The algorithm used to calculate new values for a graph is called a stat, short for
statistical transformation. The following figure describes how this process works with geom_bar().</p>
<p align="center">
  <img src="images/t4/31.png" style="width:100%"/>
</p>
<p>The diamonds dataset comes in ggplot2 and contains information about ~54,000 diamonds, including the price, carat, color, clarity, and cut of each diamond. The chart shows that more diamonds are available with high-quality cuts than with low quality cuts:</p>
<pre><code class="language-r">ggplot(data = diamonds) +
  geom_bar(mapping = aes(x = cut))
</code></pre>
<p align="center">
  <img src="images/t4/32.png" style="width:70%"/>
</p>
<h4 id="common-geom-with-statistical-transformation"><a class="header" href="#common-geom-with-statistical-transformation">Common geom with statistical transformation</a></h4>
<p>Typically, you will create layers using a <code>geom_ function</code>.</p>
<ul>
<li>geom_bar, bar chart
<ul>
<li>stat=&quot;count&quot;</li>
</ul>
</li>
<li>geom_histogram, histogram
<ul>
<li>stat=&quot;bin&quot;</li>
</ul>
</li>
<li>geom_point, scatterplot
<ul>
<li>stat=&quot;identity&quot;</li>
</ul>
</li>
<li>geom_qq, quantile-quantile plot
<ul>
<li>stat=&quot;qq&quot;</li>
</ul>
</li>
<li>geom_boxplot, boxplot
<ul>
<li>stat=&quot;boxplot&quot;</li>
</ul>
</li>
<li>geom_line, line chart
<ul>
<li>stat=&quot;identity&quot;</li>
</ul>
</li>
</ul>
<p><strong>Therefore, we can use <code>stat</code> function instead of <code>geom</code>.</strong></p>
<p>As we mentioned in the previous class, each stat has a default geom function.</p>
<ul>
<li>stat_count</li>
<li>stat_qq</li>
<li>stat_identity</li>
<li>stat_bin</li>
<li>stat_boxplot</li>
</ul>
<h4 id="stat_count"><a class="header" href="#stat_count"><code>stat_count</code></a></h4>
<p><code>geom_bar</code> shows the default value for stat is “count,” which means that <code>geom_bar()</code> uses <code>stat_count()</code>.</p>
<p><code>geom_bar()</code> uses <code>stat_count()</code> by default: it counts the number of cases at each <code>x</code> position.</p>
<p>For example, you can re-create the previous plot using <code>stat_count()</code> instead of <code>geom_bar()</code>:</p>
<pre><code class="language-r">ggplot(data = diamonds) +
  stat_count(mapping = aes(x = cut))
</code></pre>
<p align="center">
  <img src="images/t4/33.png" style="width:70%"/>
</p>
<h4 id="stat_qq"><a class="header" href="#stat_qq"><code>stat_qq</code></a></h4>
<pre><code class="language-r">ggplot(mpg)+
  stat_qq(aes(sample=cty))
</code></pre>
<p align="center">
  <img src="images/t4/34.png" style="width:70%"/>
</p>
<h4 id="stat_identity"><a class="header" href="#stat_identity"><code>stat_identity</code></a></h4>
<pre><code class="language-r">ggplot(mpg)+
  stat_identity(aes(displ,cty))
</code></pre>
<p align="center">
  <img src="images/t4/35.png" style="width:70%"/>
</p>
<h4 id="stat_bin"><a class="header" href="#stat_bin"><code>stat_bin</code></a></h4>
<pre><code class="language-r">ggplot(mpg)+
  stat_bin(aes(cty))
</code></pre>
<p align="center">
  <img src="images/t4/36.png" style="width:70%"/>
</p>
<h4 id="stat_boxplot"><a class="header" href="#stat_boxplot"><code>stat_boxplot</code></a></h4>
<pre><code class="language-r">ggplot(mpg)+
  stat_boxplot(aes(class,cty))
</code></pre>
<p align="center">
  <img src="images/t4/37.png" style="width:70%"/>
</p>
<h4 id="identity-stat"><a class="header" href="#identity-stat">Identity stat</a></h4>
<p>If you want the y axis of bar chart to represent values instead of count, use <code>stat=&quot;identity&quot;</code></p>
<pre><code class="language-r">ggplot(data = diamonds) +
  geom_bar(mapping = aes(x = cut, y=price), stat=&quot;identity&quot;)
</code></pre>
<p align="center">
  <img src="images/t4/38.png" style="width:70%"/>
</p>
<p>If you want the heights of the bars to represent values in the data, use geom_col() instead, which is the identity stat version of geom_bar</p>
<pre><code class="language-r">ggplot(data = diamonds) +
  geom_col(mapping = aes(x = cut, y=price))
</code></pre>
<p align="center">
  <img src="images/t4/39.png" style="width:70%"/>
</p>
<h4 id="stat-proportion"><a class="header" href="#stat-proportion">Stat proportion</a></h4>
<pre><code class="language-r">ggplot(data = diamonds) +
  geom_bar(mapping = aes(x = cut, y = ..prop.., group = 1))
</code></pre>
<p align="center">
  <img src="images/t4/40.png" style="width:70%"/>
</p>
<h3 id="position-adjustments"><a class="header" href="#position-adjustments">Position Adjustments</a></h3>
<p>There’s one more piece of magic associated with bar charts. You can color a bar chart using either the color aesthetic, or more usefully, fill:</p>
<pre><code class="language-r">ggplot(data = diamonds) +
  geom_bar(aes(x = cut,
               color = cut))
</code></pre>
<p align="center">
  <img src="images/t4/41.png" style="width:70%"/>
</p>
<pre><code class="language-r">ggplot(data = diamonds) +
  geom_bar(aes(x = cut,
               fill = cut))
</code></pre>
<p align="center">
  <img src="images/t4/42.png" style="width:70%"/>
</p>
<h4 id="position-adjustments-stack"><a class="header" href="#position-adjustments-stack">Position Adjustments: stack</a></h4>
<p>Note what happens if you map the fill aesthetic to another variable, like clarity: the bars are automatically stacked. Each colored rectangle represents a combination of cut and clarity:</p>
<pre><code class="language-r">ggplot(data = diamonds) +
  geom_bar(mapping = aes(x = cut, fill = clarity))
</code></pre>
<p align="center">
  <img src="images/t4/43.png" style="width:70%"/>
</p>
<h4 id="position-adjustments-identity"><a class="header" href="#position-adjustments-identity">Position Adjustments: identity</a></h4>
<p><code>position = &quot;identity&quot;</code> will place each object exactly where it falls in the context of the graph.
This is not very useful for bars, because it overlaps them.</p>
<pre><code class="language-r">ggplot(data = diamonds,
       mapping = aes(x = cut, fill = clarity)) +
       geom_bar(position = &quot;identity&quot;)
</code></pre>
<p align="center">
  <img src="images/t4/43.png" style="width:70%"/>
</p>
Well, you may notice something wrong here. (Yes)
<p>To be clearer, we change the transparancy of the bars.</p>
<pre><code class="language-r">ggplot(data = diamonds,
       mapping = aes(x = cut, fill = clarity)) +
       geom_bar(alpha=1/5,position = &quot;identity&quot;)
</code></pre>
<p>Did you notice that some of the bars are overlaping?</p>
<p align="center">
  <img src="images/t4/43.png" style="width:70%"/>
</p>
<p>Therefore, we need to be careful with <code>identity</code>.</p>
<p>You may use the following methods to fix this issue.</p>
<h4 id="position-adjustments-fill"><a class="header" href="#position-adjustments-fill">Position Adjustments: fill</a></h4>
<p><code>position = &quot;fill&quot;</code> works like stacking, but makes each set of stacked bars the same height. This makes it easier to compare proportions across groups:</p>
<pre><code class="language-r">ggplot(data = diamonds) +
  geom_bar(mapping = aes(x = cut, fill = clarity),
  position = &quot;fill&quot;)
</code></pre>
<p align="center">
  <img src="images/t4/46.png" style="width:70%"/>
</p>
<h4 id="position-adjustments-dodge"><a class="header" href="#position-adjustments-dodge">Position Adjustments: dodge</a></h4>
<p><code>position = &quot;dodge&quot;</code> places overlapping objects directly beside one another. This makes it easier to compare individual values:</p>
<pre><code class="language-r">ggplot(data = diamonds) +
  geom_bar(mapping = aes(x = cut, fill = clarity),
  position = &quot;dodge&quot;)
</code></pre>
<p align="center">
  <img src="images/t4/47.png" style="width:70%"/>
</p>
<h4 id="position-adjustments-jitter"><a class="header" href="#position-adjustments-jitter">Position Adjustments: jitter</a></h4>
<p>There’s one other type of adjustment that’s not useful for bar charts, but it can be very useful for scatterplots. Recall our first scatterplot. Did you notice that the plot displays only 126 points, even though there are 234 observations in the dataset?</p>
<pre><code class="language-r">ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy))
</code></pre>
<p align="center">
  <img src="images/t4/48.png" style="width:70%"/>
</p>
<p><code>position = &quot;jitter&quot;</code> adds a small amount of random noise to each point. This spreads the points out because no two points are likely to receive the same amount of random noise:</p>
<pre><code class="language-r">ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy),
  position = &quot;jitter&quot;)
</code></pre>
<p align="center">
  <img src="images/t4/49.png" style="width:70%"/>
</p>
<h4 id="dual-y-axis"><a class="header" href="#dual-y-axis">Dual y axis</a></h4>
<p>Two y variables with one y axis, the cty is shifted down.</p>
<pre><code class="language-r">ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy)) +
  geom_smooth(mapping = aes(x = displ, y = cty))
</code></pre>
<p align="center">
  <img src="images/t4/50.png" style="width:70%"/>
</p>
<p><code>sec_axis()</code> function is able to deal with dual axis</p>
<pre><code class="language-r">ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy)) +
  geom_smooth(mapping = aes(x = displ, y = cty))+
    scale_y_continuous(sec.axis = sec_axis(~.*0.7, name = &quot;cty&quot;))
</code></pre>
<p align="center">
  <img src="images/t4/51.png" style="width:70%"/>
</p>
<h3 id="coordinate-systems"><a class="header" href="#coordinate-systems">Coordinate Systems</a></h3>
<p>Coordinate systems are probably the most complicated part of ggplot2. The default coordinate system is the Cartesian coordinate system where the x and y position act independently to find the location of each point.</p>
<pre><code class="language-r"># first: install.packages(c(&quot;maps&quot;,&quot;mapproj&quot;)) ----
# then ----
sw &lt;- map_data(&quot;state&quot;,
               region = c(&quot;texas&quot;,
                          &quot;oklahoma&quot;,
                          &quot;louisiana&quot;))
ggplot(sw) +
  geom_polygon(
    mapping = aes(x = long,
                  y = lat,
                  group = group),
    fill = NA,
    color = &quot;black&quot;
  ) +
  coord_map()
</code></pre>
<p align="center">
  <img src="images/t4/52.png" style="width:70%"/>
</p>
<p><strong>But what if we don't have geocode information</strong></p>
<ol>
<li>ggmap package will return geocodes from cities' name. However, as of mid-2018, google map requires a registered API key, which needs a valid credit card (SAD!).</li>
<li>Therefore, we have to find an altervative way. You could find geocodes data table included cities name on: census.gov or other open liscence sources, e.g. ods.</li>
</ol>
<p>Then, how to connect geocode table with our original data table by using base function?</p>
<h4 id="merge-geocode-with-citys-name-or-zip-or-both"><a class="header" href="#merge-geocode-with-citys-name-or-zip-or-both">Merge geocode with city's name or zip or both</a></h4>
<pre><code class="language-r">cities &lt;-
  data.frame(
    City = c(&quot;Boston&quot;, &quot;Newton&quot;, &quot;Cambridge&quot;),
    Zip = c(2110, 28658, 5444)
  )
gcode &lt;-
  read.csv(&quot;E:/IE6600/materials/R/R/hwData/usZipGeo.csv&quot;, sep = &quot;;&quot;)
newCities &lt;-
  merge(cities, gcode, by.x = c(&quot;City&quot;, &quot;Zip&quot;)) %&gt;%
  subset(select = c(&quot;City&quot;, &quot;Zip&quot;, &quot;Longitude&quot;, &quot;Latitude&quot;))
newCities
</code></pre>
<pre><code>##        City   Zip Longitude Latitude
## 1    Boston  2110 -71.05365 42.35653
## 2 Cambridge  5444 -72.90151 44.64565
## 3    Newton 28658 -81.23443 35.65344
</code></pre>
<h4 id="coordinate-systems-polar"><a class="header" href="#coordinate-systems-polar">Coordinate Systems: polar</a></h4>
<p>For example, first we do a barchart based on the <code>diamonds</code> dataset.</p>
<pre><code class="language-r">ggplot(data = diamonds) +
  geom_bar(
    mapping = aes(x = cut, fill = cut),
    show.legend = FALSE,
    width = 1
  ) +
  theme(aspect.ratio = 1) +
  labs(x = NULL, y = NULL)+
  coord_flip()
</code></pre>
<p align="center">
  <img src="images/t4/53.png" style="width:70%"/>
</p>
<p>Then we convert it to a polar system by using <code>coord_polar()</code>.</p>
<pre><code class="language-r">ggplot(data = diamonds) +
  geom_bar(
    mapping = aes(x = cut, fill = cut),
    show.legend = FALSE,
    width = 1
  ) +
  theme(aspect.ratio = 1) +
  labs(x = NULL, y = NULL)+
  coord_polar()
</code></pre>
<p align="center">
  <img src="images/t4/54.png" style="width:70%"/>
</p>
<h3 id="bar-chart-vs-histogram"><a class="header" href="#bar-chart-vs-histogram">Bar chart vs Histogram</a></h3>
<pre><code class="language-r">ggplot(data = mpg, mapping = aes(x=drv)) +
    geom_bar()
</code></pre>
<p align="center">
  <img src="images/t4/55.png" style="width:70%"/>
</p>
<pre><code class="language-r">ggplot(data = mpg, mapping = aes(x=cty)) +
  geom_histogram()
</code></pre>
<p align="center">
  <img src="images/t4/56.png" style="width:70%"/>
</p>
<h3 id="boxplot"><a class="header" href="#boxplot">Boxplot</a></h3>
<pre><code class="language-r">ggplot(data = mpg, mapping = aes(x = class, y = hwy)) +
  geom_boxplot()
</code></pre>
<p align="center">
  <img src="images/t4/57.png" style="width:70%"/>
</p>
<pre><code class="language-r">ggplot(data = mpg, mapping = aes(x = class, y = hwy)) +
  geom_boxplot(aes(color=class))
</code></pre>
<p align="center">
  <img src="images/t4/58.png" style="width:70%"/>
</p>
<h3 id="scatter-plot"><a class="header" href="#scatter-plot">Scatter plot</a></h3>
<pre><code class="language-r">ggplot(data = mpg,
       mapping = aes(x = displ, y = hwy)) +
       geom_point()
</code></pre>
<p align="center">
  <img src="images/t4/59.png" style="width:70%"/>
</p>
What do you think of this plot? Can it be improved?
<h3 id="jitter"><a class="header" href="#jitter">Jitter</a></h3>
<pre><code class="language-r">ggplot(data = mpg,
       mapping = aes(x = displ, y = hwy)) +
       geom_point(position = &quot;jitter&quot;)
</code></pre>
<p align="center">
  <img src="images/t4/60.png" style="width:70%"/>
</p>
Better?
<h3 id="avoid-overlapping"><a class="header" href="#avoid-overlapping">Avoid overlapping</a></h3>
<pre><code class="language-r">ggplot(diamonds, mapping = aes(x = carat, y = price)) +
  geom_point()
</code></pre>
<p align="center">
  <img src="images/t4/61.png" style="width:70%"/>
</p>
<h4 id="avoid-overlapping-change-size"><a class="header" href="#avoid-overlapping-change-size">Avoid overlapping: Change size</a></h4>
<pre><code class="language-r">ggplot(diamonds, mapping=aes(x=carat, y=price)) +
  geom_point(size=0.1)
</code></pre>
<p align="center">
  <img src="images/t4/62.png" style="width:70%"/>
</p>
<h4 id="avoid-overlapping-change-alpha"><a class="header" href="#avoid-overlapping-change-alpha">Avoid overlapping: Change alpha</a></h4>
<pre><code class="language-r">ggplot(diamonds, mapping=aes(x=carat, y=price)) +
  geom_point(alpha=0.1)
</code></pre>
<p align="center">
  <img src="images/t4/63.png" style="width:70%"/>
</p>
<h4 id="references"><a class="header" href="#references">References</a></h4>
<p>[1] <a href="http://extremepresentation.typepad.com/files/choosing-a-good-chart-09.pdf">Dr. Andrew Abela, Choosing a good chart</a> <br />
[2] <a href="https://r4ds.had.co.nz/">Hadley Wickham, Garrett Grolemund. R For Data Science.</a> <br />
[3] <a href="https://vita.had.co.nz/papers/layered-grammar.pdf">Hadley Wickham, A layered grammar of graphics</a><br />
[4] <a href="https://r-graphics.org/">Winston Chang, R Graphics Cookbook</a></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="t3_gramar.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="t5_transData.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="t3_gramar.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="t5_transData.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>


        <!-- Google Analytics Tag -->
        <script type="text/javascript">
            var localAddrs = ["localhost", "127.0.0.1", ""];

            // make sure we don't activate google analytics if the developer is
            // inspecting the book locally...
            if (localAddrs.indexOf(document.location.hostname) === -1) {
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

                ga('create', 'G-FKYT6Q0ZR3', 'auto');
                ga('send', 'pageview');
            }
        </script>


        <script type="text/javascript">
            window.playground_copyable = true;
        </script>

        <script src="ace.js" type="text/javascript" charset="utf-8"></script>
        <script src="editor.js" type="text/javascript" charset="utf-8"></script>
        <script src="mode-rust.js" type="text/javascript" charset="utf-8"></script>
        <script src="theme-dawn.js" type="text/javascript" charset="utf-8"></script>
        <script src="theme-tomorrow_night.js" type="text/javascript" charset="utf-8"></script>

        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
