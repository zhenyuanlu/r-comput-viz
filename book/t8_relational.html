<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Visualizing Relational Data - Computation and Visualization in R</title>


        <!-- Custom HTML head -->
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="home.html">Home</a></li><li class="chapter-item expanded affix "><a href="dis.html">Disclaimer</a></li><li class="chapter-item expanded affix "><a href="faq.html">FAQ for the class</a></li><li class="chapter-item expanded "><a href="t1_basicR.html"><strong aria-hidden="true">1.</strong> Basic of R</a></li><li class="chapter-item expanded "><a href="t2_func.html"><strong aria-hidden="true">2.</strong> R Functions</a></li><li class="chapter-item expanded "><a href="t3_gramar.html"><strong aria-hidden="true">3.</strong> The Grammar of Graphics</a></li><li class="chapter-item expanded "><a href="t4_basicViz.html"><strong aria-hidden="true">4.</strong> Basic Data Visualization in R</a></li><li class="chapter-item expanded "><a href="t5_transData.html"><strong aria-hidden="true">5.</strong> Data Transformation with dplyr</a></li><li class="chapter-item expanded "><a href="t6_dataWrangling_trt.html"><strong aria-hidden="true">6.</strong> Data Wrangling with tibbles, readr and tidyr</a></li><li class="chapter-item expanded "><a href="t7_dataWrangling_sf.html"><strong aria-hidden="true">7.</strong> (optional) Data Wrangling with stringr, forcats</a></li><li class="chapter-item expanded "><a href="t8_relational.html" class="active"><strong aria-hidden="true">8.</strong> Visualizing Relational Data</a></li><li class="chapter-item expanded "><a href="t9_shiny.html"><strong aria-hidden="true">9.</strong> Introduction to Shiny</a></li><li class="chapter-item expanded "><a href="t10_eda.html"><strong aria-hidden="true">10.</strong> Exploratory Data Analysis and More Data Visualization</a></li><li class="chapter-item expanded "><a href="t11_additional.html"><strong aria-hidden="true">11.</strong> R Modeling Workshop</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Computation and Visualization in R</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/zhenyuanlu/r-comput-viz" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="visualizing-relational-data"><a class="header" href="#visualizing-relational-data">Visualizing Relational Data</a></h1>
<h2 id="introduction"><a class="header" href="#introduction">introduction</a></h2>
<p>It’s rare that a data analysis involves only a single table of data. Typically you have many tables of data, and you must combine them to answer the questions that you’re interested in. Collectively, multiple tables of data are called relational data because it is the relations, not just the individual datasets, that are important.</p>
<p>To work with relational data you need verbs that work with pairs of tables. There are two most common families of verbs designed to work with relational data:</p>
<ul>
<li>
<p>Mutating joins, which add new variables to one data frame from matching observations in another.</p>
</li>
<li>
<p>Filtering joins, which filter observations from one data frame based on whether or not they match an observation in the other table.</p>
</li>
</ul>
<h2 id="prerequisites"><a class="header" href="#prerequisites">Prerequisites</a></h2>
<pre><code class="language-r">library(tidyverse)
library(nycflights13)
</code></pre>
<h2 id="nycflights13"><a class="header" href="#nycflights13">nycflights13</a></h2>
<p><strong>airlines</strong> lets you look up the full carrier name from its abbreviated code:</p>
<pre><code class="language-r">head(airlines)
</code></pre>
<pre><code>## # A tibble: 6 × 2
##   carrier name
##   &lt;chr&gt;   &lt;chr&gt;
## 1 9E      Endeavor Air Inc.
## 2 AA      American Airlines Inc.
## 3 AS      Alaska Airlines Inc.
## 4 B6      JetBlue Airways
## 5 DL      Delta Air Lines Inc.
## 6 EV      ExpressJet Airlines Inc.
</code></pre>
<p><strong>airports</strong> gives information about each airport, identified by the faa airport code:</p>
<pre><code class="language-r">airports
</code></pre>
<pre><code>## # A tibble: 1,458 × 8
##    faa   name                             lat    lon   alt    tz dst   tzone
##    &lt;chr&gt; &lt;chr&gt;                          &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
##  1 04G   Lansdowne Airport               41.1  -80.6  1044    -5 A     America/…
##  2 06A   Moton Field Municipal Airport   32.5  -85.7   264    -6 A     America/…
##  3 06C   Schaumburg Regional             42.0  -88.1   801    -6 A     America/…
##  4 06N   Randall Airport                 41.4  -74.4   523    -5 A     America/…
##  5 09J   Jekyll Island Airport           31.1  -81.4    11    -5 A     America/…
##  6 0A9   Elizabethton Municipal Airport  36.4  -82.2  1593    -5 A     America/…
##  7 0G6   Williams County Airport         41.5  -84.5   730    -5 A     America/…
##  8 0G7   Finger Lakes Regional Airport   42.9  -76.8   492    -5 A     America/…
##  9 0P2   Shoestring Aviation Airfield    39.8  -76.6  1000    -5 U     America/…
## 10 0S9   Jefferson County Intl           48.1 -123.    108    -8 A     America/…
## # … with 1,448 more rows
</code></pre>
<p><strong>planes</strong> gives information about each plane, identified by its tailnum:</p>
<pre><code class="language-r">planes
</code></pre>
<pre><code>## # A tibble: 3,322 × 9
##    tailnum  year type              manufacturer model engines seats speed engine
##    &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;             &lt;chr&gt;        &lt;chr&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;
##  1 N10156   2004 Fixed wing multi… EMBRAER      EMB-…       2    55    NA Turbo…
##  2 N102UW   1998 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
##  3 N103US   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
##  4 N104UW   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
##  5 N10575   2002 Fixed wing multi… EMBRAER      EMB-…       2    55    NA Turbo…
##  6 N105UW   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
##  7 N107US   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
##  8 N108UW   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
##  9 N109UW   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
## 10 N110UW   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
## # … with 3,312 more rows
</code></pre>
<p><strong>weather</strong> gives the weather at each NYC airport for each hour:</p>
<pre><code class="language-r">weather
</code></pre>
<pre><code>## # A tibble: 26,115 × 15
##    origin  year month   day  hour  temp  dewp humid wind_dir wind_speed
##    &lt;chr&gt;  &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;      &lt;dbl&gt;
##  1 EWR     2013     1     1     1  39.0  26.1  59.4      270      10.4
##  2 EWR     2013     1     1     2  39.0  27.0  61.6      250       8.06
##  3 EWR     2013     1     1     3  39.0  28.0  64.4      240      11.5
##  4 EWR     2013     1     1     4  39.9  28.0  62.2      250      12.7
##  5 EWR     2013     1     1     5  39.0  28.0  64.4      260      12.7
##  6 EWR     2013     1     1     6  37.9  28.0  67.2      240      11.5
##  7 EWR     2013     1     1     7  39.0  28.0  64.4      240      15.0
##  8 EWR     2013     1     1     8  39.9  28.0  62.2      250      10.4
##  9 EWR     2013     1     1     9  39.9  28.0  62.2      260      15.0
## 10 EWR     2013     1     1    10  41    28.0  59.6      260      13.8
## # … with 26,105 more rows, and 5 more variables: wind_gust &lt;dbl&gt;, precip &lt;dbl&gt;,
## #   pressure &lt;dbl&gt;, visib &lt;dbl&gt;, time_hour &lt;dttm&gt;
</code></pre>
<h2 id="nycflights13-entity-relationship-diagram"><a class="header" href="#nycflights13-entity-relationship-diagram">nycflights13 Entity Relationship Diagram</a></h2>
<p>One way to show the relationships between the different tables is with a drawing: <strong>If you have taken database management, you would be familiar with.</strong></p>
<p align="center">
  <img src="images/t8/erd.png" style="width:80%"/>
</p>
Hadley Wickham, Garrett Grolemund. R For Data Science.
<p>For <strong>nycflights13</strong>:</p>
<ul>
<li>
<p>flights connects to planes via a single variable, tailnum.</p>
</li>
<li>
<p>flights connects to airlines through the carrier variable.</p>
</li>
<li>
<p>flights connects to airports in two ways: via the origin and dest variables.</p>
</li>
<li>
<p>flights connects to weather via origin (the location), and year, month, day, and hour (the time).</p>
</li>
</ul>
<h2 id="key-for-relational-data-table"><a class="header" href="#key-for-relational-data-table">Key for relational data table</a></h2>
<p>There are two types of keys:</p>
<ul>
<li>
<p>A primary key uniquely identifies an observation in its own table.</p>
</li>
<li>
<p>A foreign key uniquely identifies an observation in another table.</p>
</li>
</ul>
<h3 id="primary-key-pk"><a class="header" href="#primary-key-pk">Primary key (PK)</a></h3>
<p>For example, planes$tailnum is a primary key because it uniquely identifies each plane in the planes table.</p>
<pre><code>planes
</code></pre>
<pre><code>## # A tibble: 3,322 × 9
##    tailnum  year type              manufacturer model engines seats speed engine
##    &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;             &lt;chr&gt;        &lt;chr&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;
##  1 N10156   2004 Fixed wing multi… EMBRAER      EMB-…       2    55    NA Turbo…
##  2 N102UW   1998 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
##  3 N103US   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
##  4 N104UW   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
##  5 N10575   2002 Fixed wing multi… EMBRAER      EMB-…       2    55    NA Turbo…
##  6 N105UW   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
##  7 N107US   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
##  8 N108UW   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
##  9 N109UW   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
## 10 N110UW   1999 Fixed wing multi… AIRBUS INDU… A320…       2   182    NA Turbo…
## # … with 3,312 more rows
</code></pre>
<p>If we would likt to find one plane with tailnumber &quot;<strong>N110UW</strong>&quot;</p>
<pre><code class="language-r">planes %&gt;%
  filter(tailnum==&quot;N110UW&quot;)
</code></pre>
<pre><code>## # A tibble: 1 × 9
##   tailnum  year type               manufacturer model engines seats speed engine
##   &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;              &lt;chr&gt;        &lt;chr&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;chr&gt;
## 1 N110UW   1999 Fixed wing multi … AIRBUS INDU… A320…       2   182    NA Turbo…
</code></pre>
<p>Of course, the PK can be a combination of variables:<code>c(year, month, day, hour, minute, origin)</code></p>
<pre><code class="language-r">flights %&gt;%
  filter(year==2013, month==1, day==5, hour==5, minute==40, origin==&quot;JFK&quot;)
</code></pre>
<pre><code>## # A tibble: 1 × 19
##    year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##   &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
## 1  2013     1     5      537            540        -3      831            850
## # … with 11 more variables: arr_delay &lt;dbl&gt;, carrier &lt;chr&gt;, flight &lt;int&gt;,
## #   tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;, distance &lt;dbl&gt;,
## #   hour &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;
</code></pre>
<h3 id="foreign-key"><a class="header" href="#foreign-key">Foreign key</a></h3>
<p>For example, flights$tailnum is a foreign key because it appears in the flights table where it matches each flight to a unique plane in the plane talbe. Which means in the table flights, the tailnum is a foreign key not a PK; but in the table plane, the tailnum is a PK</p>
<pre><code class="language-r">flights %&gt;%
  filter(tailnum==&quot;N110UW&quot;)
</code></pre>
<pre><code>## # A tibble: 40 × 19
##     year month   day dep_time sched_dep_time dep_delay arr_time sched_arr_time
##    &lt;int&gt; &lt;int&gt; &lt;int&gt;    &lt;int&gt;          &lt;int&gt;     &lt;dbl&gt;    &lt;int&gt;          &lt;int&gt;
##  1  2013     1    10      620            630       -10      855            831
##  2  2013    10     6      959            959         0     1214           1207
##  3  2013    10     9     1639           1540        59     1830           1742
##  4  2013    10    24     1600           1550        10     1756           1752
##  5  2013    11     6     1546           1544         2     1741           1750
##  6  2013    11     9     1458           1500        -2     1649           1656
##  7  2013    11    10      818            825        -7     1007           1029
##  8  2013    11    13     1540           1544        -4     1738           1750
##  9  2013    11    21     1222           1200        22     1413           1359
## 10  2013    11    26     1603           1544        19     1842           1750
...
</code></pre>
<h2 id="mutate-join"><a class="header" href="#mutate-join">Mutate Join</a></h2>
<h4 id="data-table"><a class="header" href="#data-table">Data table</a></h4>
<p align="center">
  <img src="images/t8/xy.png" style="width:50%"/>
</p>
<pre><code class="language-r">x &lt;- tribble(
  ~key, ~val_x,
  1, &quot;x1&quot;,
  2, &quot;x2&quot;,
  3, &quot;x3&quot;
)
y &lt;- tribble(
  ~key, ~val_y,
  1, &quot;y1&quot;,
  2, &quot;y2&quot;,
  4, &quot;y3&quot;
)
</code></pre>
<h3 id="inner-join"><a class="header" href="#inner-join">Inner join</a></h3>
<p align="center">
  <img src="images/t8/inner.png" style="width:80%"/>
</p>
<p>Base R functoin:</p>
<pre><code class="language-r">merge(x, y, by=&quot;key&quot;)

#or
x %&gt;%
  merge(y, by=&quot;key&quot;)
</code></pre>
<p>dplyr <code>inner_join()</code> function:</p>
<pre><code class="language-r">inner_join(x, y, by=&quot;key&quot;)
</code></pre>
<pre><code>## # A tibble: 2 × 3
##     key val_x val_y
##   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
## 1     1 x1    y1
## 2     2 x2    y2
</code></pre>
<pre><code class="language-r">#or
x %&gt;%
  inner_join(y, by=&quot;key&quot;)
</code></pre>
<pre><code>## # A tibble: 2 × 3
##     key val_x val_y
##   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
## 1     1 x1    y1
## 2     2 x2    y2
</code></pre>
<h4 id="if-the-keys-are-different"><a class="header" href="#if-the-keys-are-different">If the keys are different</a></h4>
<h4 id="data"><a class="header" href="#data">Data</a></h4>
<pre><code class="language-r">x &lt;- tribble(
  ~key, ~val_x,
  1, &quot;x1&quot;,
  2, &quot;x2&quot;,
  3, &quot;x3&quot;
)
y1 &lt;- tribble(
  ~key1, ~val_y,
  1, &quot;y1&quot;,
  2, &quot;y2&quot;,
  4, &quot;y3&quot;
)
</code></pre>
<p>Base function:</p>
<pre><code class="language-r">merge(x, y1, by.x=&quot;key&quot;, by.y=&quot;key1&quot;)
</code></pre>
<p>dplyr function:</p>
<pre><code class="language-r">inner_join(x, y1, by=c(&quot;key&quot;=&quot;key1&quot;))
</code></pre>
<h3 id="left-join"><a class="header" href="#left-join">Left join</a></h3>
<p align="center">
  <img src="images/t8/left.png" style="width:80%"/>
</p>
<p>Base R functoin:</p>
<pre><code class="language-r">merge(x, y, by=&quot;key&quot;, all.x=TRUE)
#or
x %&gt;%
  merge(y, by=&quot;key&quot;, all.x=TRUE)
</code></pre>
<p>dplyr <code>left_join()</code> function:</p>
<pre><code class="language-r">left_join(x, y, by=&quot;key&quot;)
</code></pre>
<pre><code>## # A tibble: 3 × 3
##     key val_x val_y
##   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
## 1     1 x1    y1
## 2     2 x2    y2
## 3     3 x3    &lt;NA&gt;
</code></pre>
<pre><code class="language-r">#or
x %&gt;%
  left_join(y, by=&quot;key&quot;)
</code></pre>
<pre><code>## # A tibble: 3 × 3
##     key val_x val_y
##   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
## 1     1 x1    y1
## 2     2 x2    y2
## 3     3 x3    &lt;NA&gt;
</code></pre>
<h3 id="right-join"><a class="header" href="#right-join">Right join</a></h3>
<p align="center">
  <img src="images/t8/right.png" style="width:80%"/>
</p>
<p>Base R functoin:</p>
<pre><code class="language-r">merge(x, y, by=&quot;key&quot;, all.y=TRUE)
#or
x %&gt;%
  merge(y, by=&quot;key&quot;, all.y=TRUE)
</code></pre>
<p>dplyr <code>right_join()</code> function:</p>
<pre><code class="language-r">right_join(x, y, by=&quot;key&quot;)
</code></pre>
<pre><code>## # A tibble: 3 × 3
##     key val_x val_y
##   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
## 1     1 x1    y1
## 2     2 x2    y2
## 3     4 &lt;NA&gt;  y3
</code></pre>
<pre><code class="language-r">#or
x %&gt;%
  right_join(y, by=&quot;key&quot;)
</code></pre>
<pre><code>## # A tibble: 3 × 3
##     key val_x val_y
##   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
## 1     1 x1    y1
## 2     2 x2    y2
## 3     4 &lt;NA&gt;  y3
</code></pre>
<h3 id="full-join"><a class="header" href="#full-join">Full join</a></h3>
<p align="center">
  <img src="images/t8/full.png" style="width:80%"/>
</p>
<p>Base R functoin:</p>
<pre><code class="language-r">merge(x, y, by=&quot;key&quot;,
      all.x=TRUE,
      all.y = TRUE)
#or
x %&gt;%
  merge(y, by=&quot;key&quot;,
        all.x=TRUE,
        all.y = TRUE)
</code></pre>
<p>dplyr <code>full_join()</code> function:</p>
<pre><code class="language-r">full_join(x, y, by=&quot;key&quot;)
</code></pre>
<pre><code>## # A tibble: 4 × 3
##     key val_x val_y
##   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
## 1     1 x1    y1
## 2     2 x2    y2
## 3     3 x3    &lt;NA&gt;
## 4     4 &lt;NA&gt;  y3
</code></pre>
<pre><code class="language-r">#or
x %&gt;%
  full_join(y, by=&quot;key&quot;)
</code></pre>
<pre><code>## # A tibble: 4 × 3
##     key val_x val_y
##   &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;
## 1     1 x1    y1
## 2     2 x2    y2
## 3     3 x3    &lt;NA&gt;
## 4     4 &lt;NA&gt;  y3
</code></pre>
<h2 id="filtering-joins"><a class="header" href="#filtering-joins">Filtering Joins</a></h2>
<ul>
<li>semi_join(x, y) keeps all observations in x that have a match in y.</li>
<li>anti_join(x, y) drops all observations in x that have a match in y.</li>
</ul>
<h3 id="semi-join"><a class="header" href="#semi-join">Semi-join</a></h3>
<p align="center">
  <img src="images/t8/semi.png" style="width:80%"/>
</p>
<p><code>semi_join(x, y)</code> keeps all observations in x that have a match in y.</p>
<h3 id="anti-join"><a class="header" href="#anti-join">Anti-join</a></h3>
<p align="center">
  <img src="images/t8/anti.png" style="width:80%"/>
</p>
<p><code>anti_join(x, y)</code> drops all observations in x that have a match in y.</p>
<h4 id="references"><a class="header" href="#references">References</a></h4>
<p>[1] <a href="https://r4ds.had.co.nz/">Hadley Wickham, Garrett Grolemund. R For Data Science.</a></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="t7_dataWrangling_sf.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="t9_shiny.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="t7_dataWrangling_sf.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="t9_shiny.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script type="text/javascript">
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script type="text/javascript">
            window.playground_copyable = true;
        </script>

        <script src="ace.js" type="text/javascript" charset="utf-8"></script>
        <script src="editor.js" type="text/javascript" charset="utf-8"></script>
        <script src="mode-rust.js" type="text/javascript" charset="utf-8"></script>
        <script src="theme-dawn.js" type="text/javascript" charset="utf-8"></script>
        <script src="theme-tomorrow_night.js" type="text/javascript" charset="utf-8"></script>

        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->


    </body>
</html>
